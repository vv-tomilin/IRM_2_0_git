/*! For license information please see main.608491e1.chunk.js.LICENSE.txt */
(this["webpackJsonpcharts-subapp"]=this["webpackJsonpcharts-subapp"]||[]).push([[0],{499:function(e,t,n){},500:function(e,t,n){},502:function(e,t,n){"use strict";n.r(t),n.d(t,"NOT_ATVISE",(function(){return kt})),n.d(t,"SIMULATION_ATVISE",(function(){return Tt})),n.d(t,"RStateInitialization",(function(){return St}));var a=n(0),r=n.n(a),c=n(11),i=n.n(c),s=n(172),o=n(15),l=n(4),u=n(8),d=n(63),f=function(e,t){var n;return function(){for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];var i=function(){clearTimeout(n),e.apply(void 0,r)};clearTimeout(n),n=setTimeout(i,t)}};function p(e,t){var n=0;return function(){var a=(new Date).getTime();if(!(a-n<t))return n=a,e.apply(void 0,arguments)}}function j(e,t){for(var n=0,a=e.length-1;;){var r=Math.floor((n+a)/2);if(r===n)return t-e[n]<=e[a]-t?e[n]:e[a];var c=e[r];if(c===t)return c;c>t&&(a=r),c<t&&(n=r)}}var b=function(e,t){return e/t-10},m=function(e){var t=Math.trunc(Date.now()/1e3);return[Math.trunc(t-e),t]},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1800;return[e-t,e]},v=function(e){return new Date(1e3*e).toISOString().replace(/T.*/,"T00:00")},O=function(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))},_=function(e){return"mouseup"!==e&&"mousedown"!==e},x=function(){return!0},g=function e(t){var n=function(t){return"object"===typeof t?e(t):t};return t?Array.isArray(t)?t.map(n):Object.keys(t).reduce((function(e,a){return e[a]=n(t[a]),e}),{}):t},w=d.default.fmtDate("{D}.{M}.{YY} {HH}:{mm}:{ss}"),y=function(e){return[Math.floor(e/3600),Math.floor(e/60)%60,e%60].map((function(e){return e<10?"0"+e:e})).join(":")},E=n(30),k="dark",T="light",S=function(e){return e===k?{active_theme:k,skeleton:"#1f1f1f",color:"#f8f9f4"}:e===T?{active_theme:T,skeleton:"rgba(0, 0, 0, 0.11)",color:"#1f1f1f"}:void 0},I=localStorage.getItem("theme")||"dark";document.body.setAttribute("data-theme",I);var D=Object.fromEntries(new URLSearchParams(window.location.search)),A={state:"INITIAL",wellid:D.id,authid:D.auth,scrollVelocity:30,dataInterval:null,merge_step:1800,livemode:!0,color_schema:S(I)},C=[[31536e3,"{YYYY}",null,null,null,null,null,null,1],[2419200,"{MMM}","\n{YYYY}",null,null,null,null,null,1],[86400,"{M}/{D}","\n{YYYY}",null,null,null,null,null,1],[3600,"{HH}:{mm}","\n{D}/{M}/{YY}",null,"\n{D}/{M}",null,null,null,1],[60,"{HH}:{mm}","\n{D}/{M}/{YY}",null,"\n{D}/{M}/{YY}",null,null,null,1],[1,"{HH}:{mm}:{ss}","\n{D}/{M}/{YY}",null,"\n{D}/{M}/{YY}",null,null,null,1]],N=[{key:60,label:"1 \u043c\u0438\u043d"},{key:300,label:"5 \u043c\u0438\u043d"},{key:600,label:"10 \u043c\u0438\u043d"},{key:1800,label:"30 \u043c\u0438\u043d"},{key:3600,label:"1 \u0447",disabled_in_livemode:!0},{key:7200,label:"2 \u0447",disabled_in_livemode:!0},{key:14400,label:"4 \u0447",disabled_in_livemode:!0},{key:28800,label:"8 \u0447",disabled_in_livemode:!0},{key:43200,label:"12 \u0447",disabled_in_livemode:!0},{key:86400,label:"24 \u0447",disabled_in_livemode:!0}],R={60:"1 \u043c\u0438\u043d",300:"5 \u043c\u0438\u043d",600:"10 \u043c\u0438\u043d",1800:"30 \u043c\u0438\u043d",3600:"1 \u0447",7200:"2 \u0447",14400:"4 \u0447",28800:"8 \u0447",43200:"12 \u0447",86400:"24 \u0447"},L=[60,300,600,1800,3600,7200,14400,28800,43200,86400],M=n(1),U={},H=Object(s.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"OFF_LIVEMODE":return Object(u.a)(Object(u.a)({},e),{},{livemode:!1});case"CREATE_STRUCTURE":var r=a.config,c=a.data,i=Object.entries(r.settings).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].length})),s=i.map((function(e){return Object(l.a)(e,1)[0]})),d=20*Math.max.apply(Math,Object(o.a)(i.map((function(e){return e[1].length}))))+20,f=Object.fromEntries(i.map((function(e){var t=Object(l.a)(e,2);return[t[0],t[1].map((function(e){var t=e.sensor_name;return c[t]||{data:Array(c.DataTimes.data.length).fill(null)}}))]}))),p=e.hasOwnProperty("lastValues")?e.lastValues:Object.fromEntries(i.map((function(e){return[Object(l.a)(e,1)[0],[]]}))),m=null,h=null,v=null;document.querySelector(".root2__wrapper");kt&&(m=document.querySelector(".charts-container")||document.querySelector(".charts-skeleton"),h=b(m.clientWidth,s.length),v=window.innerHeight-d);var _=c.DataTimes.data,x=_[0],g=_[_.length-1],y=[x,g];return Object(u.a)(Object(u.a)({},e),{},{state:"READY",info:r.info,times:c.DataTimes,depth:c.WellDepth,operations:c.Operation,all_sensors:r.all_sensors,dataInterval:y,timeInterval:y,blocks:s,blockSize:{width:h,height:v},settings:Object.fromEntries(i),lastValues:p,ma_offset:d},f);case"UPDATE_BLOCK_BOUNDING":var k=e.state,T=e.blocks,I=e.ma_offset;if("READY"===k){var D=a.containerWidth,C=a.containerHeight,N=b(D,T.length),R=C-I;return Object(u.a)(Object(u.a)({},e),{},{blockSize:{width:N,height:R}})}return e;case"UPDATE_TIME_INTERVAL":var H=e.timeInterval,P=e.scrollVelocity,V=e.livemode,F=e.lastValues,W=a.delta,B=a.scale,G=H,Y=Object(l.a)(H,2),z=Y[0],q=Y[1];if(B){var K=q-P-(z+P);W>0&&K>=60&&(G=[z+P,q-P]),W<0&&(G=[z-P,q+P])}else{var J=W>0?P:-P;G=H.map((function(e){return e-J}))}var Q=F;return V&&(Q=Object.fromEntries(Object.entries(F).map((function(e){return[Object(l.a)(e,1)[0],[]]})))),Object(u.a)(Object(u.a)({},e),{},{timeInterval:G,livemode:!1,lastValues:Q});case"CHECK_IF_DATA_UPDATE_NEEDED":var X=e.timeInterval,Z=e.dataInterval,$=e.merge_step,ee=e.livemode,te=Object(l.a)(X,2),ne=te[0],ae=te[1],re=Object(l.a)(Z,2),ce=re[0],ie=re[1],se=Math.trunc((new Date).getTime()/1e3);if(ne<ce&&O("REQUEST_DATA_UPDATE",[ce-$,ce]),ae>ie&&!ee&&ae<se){var oe=ie+$,le=oe>se?se:oe;O("REQUEST_DATA_UPDATE",[ie,le])}var ue=j(L,ae-ne);if(ue!==$){var de=ue/30;return Object(u.a)(Object(u.a)({},e),{},{merge_step:ue,scrollVelocity:de})}return e;case"MERGE_WITH_UPDATE":var fe=a.data,pe=a.range,je=Object(l.a)(e.dataInterval,2),be=je[0],me=je[1],he=Object(l.a)(pe,2),ve=he[0],Oe=he[1];if(Oe===be){var _e=Object.fromEntries(e.blocks.map((function(t){var n=e[t],a=e.settings[t].map((function(e){var t=e.sensor_name;return fe[t]||{data:Array(fe.DataTimes.data.length).fill(null)}}));return[t,n.map((function(e,t){return{data:a[t].data.concat(e.data)}}))]}))),xe={data:fe.DataTimes.data.concat(e.times.data)},ge={data:fe.WellDepth.data.concat(e.depth.data)},we={data:fe.Operation.data.concat(e.operations.data)};return Object(u.a)(Object(u.a)(Object(u.a)({},e),_e),{},{times:xe,depth:ge,operations:we,dataInterval:[ve,me],timeInterval:Object(o.a)(e.timeInterval)})}if(ve===me){var ye=Object.fromEntries(e.blocks.map((function(t){var n=e[t],a=e.settings[t].map((function(e){var t=e.sensor_name;return fe[t]||{data:Array(fe.DataTimes.data.length).fill(null)}}));return[t,n.map((function(e,t){return{data:e.data.concat(a[t].data)}}))]}))),Ee={data:e.times.data.concat(fe.DataTimes.data)},ke={data:e.depth.data.concat(fe.WellDepth.data)},Te={data:e.operations.data.concat(fe.Operation.data)};return Object(u.a)(Object(u.a)(Object(u.a)({},e),ye),{},{times:Ee,depth:ke,operations:Te,dataInterval:[be,Oe],timeInterval:Object(o.a)(e.timeInterval)})}return e;case"UPDATE_CHARTS":var Se=e.settings,Ie=e.lastValues,De=a.data,Ae=a.merge_step,Ce=a.livemode,Ne=Object.fromEntries(Object.entries(Se).map((function(e){var t=Object(l.a)(e,2);return[t[0],t[1].map((function(e){var t=e.sensor_name;return De[t]||{data:Array(De.DataTimes.data.length).fill(null)}}))]}))),Re=De.DataTimes.data,Le=Re[0],Me=Re[Re.length-1],Ue=Ie;return Ce||(Ue=Object.fromEntries(Object.entries(Se).map((function(e){return[Object(l.a)(e,1)[0],[]]})))),Object(u.a)(Object(u.a)(Object(u.a)({},e),Ne),{},{merge_step:Ae,times:De.DataTimes,depth:De.WellDepth,operations:De.Operation,dataInterval:[Le,Me],timeInterval:[Le,Me],scrollVelocity:Ae/60,lastValues:Ue,livemode:Ce});case"ADD_DATA_FROM_SOCKET":var He=e.dataInterval,Pe=e.timeInterval,Ve=Object(l.a)(He,2),Fe=Ve[0],We=Ve[1],Be=Object(l.a)(Pe,2),Ge=Be[0],Ye=Be[1],ze=a.DataTimes[0]-Ye;if(ze>0){var qe=Object.fromEntries(Object.entries(e.settings).map((function(t){var n=Object(l.a)(t,2),r=n[0],c=n[1].map((function(t,n){var c=t.sensor_name,i=a[c]||{data:[null]},s=Object(o.a)(e[r][n].data);return s.push.apply(s,Object(o.a)(i.data)),{data:s}}));return[r,c]}))),Ke=Object(o.a)(e.times.data);Ke.push.apply(Ke,Object(o.a)(a.DataTimes));var Je={data:Ke},Qe=Object(o.a)(e.depth.data);Qe.push.apply(Qe,Object(o.a)(a.WellDepth.data));var Xe={data:Qe},Ze=Object(o.a)(e.operations.data);Ze.push.apply(Ze,Object(o.a)(a.Operation.data));var $e={data:Ze},et=Object.fromEntries(Object.entries(e.settings).map((function(e){var t=Object(l.a)(e,2);return[t[0],t[1].map((function(e){var t,n;if((null===(t=a[e.sensor_name])||void 0===t?void 0:t.data)>e.sensor_max&&!U[e.sensor_name]){E.b.warn((function(){var t;return Object(M.jsxs)("div",{children:["".concat(w(new Date(1e3*a.DataTimes))," \xb7 ").concat(a.WellDepth.data," \u043c"),Object(M.jsx)("div",{children:"".concat(e.sensor_name_ru,":  ").concat(null===(t=a[e.sensor_name])||void 0===t?void 0:t.data," ").concat(e.sensor_unit)})]})}),{toastId:e.sensor_name}),U[e.sensor_name]=!0,setTimeout((function(){return delete U[e.sensor_name]}),18e5)}return(null===(n=a[e.sensor_name])||void 0===n?void 0:n.data)||""}))]})));return Object(u.a)(Object(u.a)(Object(u.a)({},e),qe),{},{times:Je,depth:Xe,operations:$e,timeInterval:[Ge+ze,Ye+ze],dataInterval:[Fe,We+ze],lastValues:et})}return e;case"PUSH_ERROR_TO_STATE":return{state:"ERROR",error:a};case"SET_THEME":return document.body.setAttribute("data-theme",a),localStorage.setItem("theme",a),Object(u.a)(Object(u.a)({},e),{},{color_schema:S(a)});default:return e}})),P=n(5),V=function(e){return e.state},F=function(e){return e.blocks},W=function(e){return e.timeInterval},B=function(e){return e.times.data},G=function(e){return e.depth.data},Y=function(e){return e.operations.data},z=function(e){return e.blockSize},q=function(e){return e.info},K=function(e){return e.livemode},J=function(e){return e.merge_step},Q=function(e){return e.color_schema},X=n(10),Z=n.n(X),$=n(12),ee=n(79),te=n.n(ee),ne=n(167),ae=n.n(ne),re=function(e){var t=e.access_token,n=e.refresh_token;localStorage.setItem("access_token",t),localStorage.setItem("refresh_token",n)},ce=te.a.create({baseURL:"https://ir-backend-02.rigintelpro.ru/api/v1/charts1111"}),ie=te.a.create({baseURL:"https://ir-backend-02.rigintelpro.ru/api/v1"});ce.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e}));var se=function(){var e=Object($.a)(Z.a.mark((function e(t){var n,a;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie.post("login",{grant_type:"refresh"},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("refresh_token"))}}).catch((function(e){if(401===e.response.status)return le(A.authid)}));case 2:return n=e.sent,a=n.data,re(a),t.response.config.headers.Authorization="Bearer ".concat(a.access_token),e.abrupt("return",Promise.resolve());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();ae()(ce,se,{pauseInstanceWhileRefreshing:!0});var oe=ce,le=function(e){return ie.post("webmaster/wm_key",{key:e}).catch((function(e){return H.dispatch({type:"PUSH_ERROR_TO_STATE",payload:{code:e.response.status,message:"\u041e\u0442\u043a\u0430\u0437\u0430\u043d\u043e \u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0435"}}),e.response}))},ue=function(e){return oe.get("NEWconfig/?".concat(e))},de=function(e,t){return oe.post("NEWconfig?".concat(e),JSON.stringify(t))},fe=function(e){return oe.get("datahistory/?".concat(e)).catch((function(e){H.dispatch({type:"PUSH_ERROR_TO_STATE",payload:{code:e.response.status,message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445"}})}))},pe=function(e){return oe.get("NEWstartstream/?".concat(e))};n(202);function je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return window.parent.rigintel?e&&window.parent.rigintel.state[e]||window.parent.rigintel.state:null}function be(e){return me.apply(this,arguments)}function me(){return(me=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:je().atvise.settings.saveSettingsFn(t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){return ve.apply(this,arguments)}function ve(){return(ve=Object($.a)(Z.a.mark((function e(t){var n,a;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,a){var r=0;je().atvise.settings[t]=null,je().atvise.settings.settingsFn(t),n=setInterval((function(){var n=je().atvise.settings[t];null!==n&&e(n),++r>500&&a()}),100)}));case 2:return a=e.sent,clearInterval(n),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(){return _e.apply(this,arguments)}function _e(){return(_e=Object($.a)(Z.a.mark((function e(){var t,n,a,r,c=arguments;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"live",n=c.length>1&&void 0!==c[1]?c[1]:null,e.next=4,new Promise((function(e,r){var c=0;je().data.value=null,je().data.fnUpdateDataValue(t,n),a=setInterval((function(){var t=je().data.value;null!==t&&e(t),++c>500&&r()}),100)}));case 4:return r=e.sent,clearInterval(a),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e){return ge.apply(this,arguments)}function ge(){return(ge=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(t);case 2:return e.abrupt("return",{data:{id:1,name:"default"}});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(){return ye.apply(this,arguments)}function ye(){return(ye=Object($.a)(Z.a.mark((function e(){var t,n,a,r=arguments;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"settingsUser",e.next=3,he(t);case 3:return n=e.sent,console.log("get to atvise settings: ",n),a={all_sensors:je().atvise.all_sensors,settings:n,info:je().atvise.info},console.log("get data: ",a),e.abrupt("return",{data:a});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e){return ke.apply(this,arguments)}function ke(){return(ke=Object($.a)(Z.a.mark((function e(t){var n,a,r,c;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(e){var t=Math.trunc((new Date).getTime()/1e3),r=e;return void 0===a?r={time_stamp_stop:t,time_stamp_start:t-1800}:a>t&&(r={time_stamp_stop:t,time_stamp_start:t-Math.abs(a-n)}),r},n=t.time_stamp_start,a=t.time_stamp_stop,e.next=4,Oe("interval",r(t));case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Te=n(108),Se=n.n(Te),Ie={pinchin:-1,pinchout:1,panup:-1,pandown:1},De=function(e){if("ontouchstart"in window){var t=H.getState().ma_offset;e.over.addEventListener("touchmove",(function(n){return e.setCursor({left:0,top:n.touches[0].clientY-t},!0,!0)})),e.over.addEventListener("touchend",(function(){return e.over.dispatchEvent(new MouseEvent("mouseleave"))}))}},Ae=function(){var e=Object(P.c)(Q);return Object(M.jsx)(E.a,{autoClose:!1,theme:e.active_theme})},Ce=n(50),Ne=n(51),Re=n.n(Ne);function Le(e){var t=document.createElement("div");t.className="u-tooltip u-tooltip-charts";var n=null,a=!1;function r(r){a||(t.style.display="block",a=!0);var c=H.getState(),i=c.operations,s=c.depth,o=c.ma_offset,l=r.data.slice(1),u=r.series.slice(1).map((function(e,t){var a,r=e.label,c=e._stroke,i=e._getMetrics;return"<span style='color: ".concat(c,"'>").concat(r,": ").concat((a=l[t][n],null===a||void 0===a?"\u043d. \u0434":a)," ").concat(i,"</span>")}));t.innerHTML="0"===e?"<p>".concat(w(new Date(1e3*r.data[0][n])),"</p>")+"<p>\u0413\u043b\u0443\u0431: ".concat(s.data[n]," \u043c</p>")+"<p>\u041e\u043f\u0435\u0440: ".concat(i.data[n].oper||"\u043d. \u0434","</p>")+u.join("\n"):u.join("\n");var d=r.valToPos(r.data[0][n],"x"),f=-20;r.height-d<o+54&&(f="0"===e?18*(u.length+3)+10:18*u.length+10),t.style.top=d-f+"px"}return{hooks:{init:[De],ready:[function(e){return e.root.querySelector(".u-wrap").appendChild(t)}],setCursor:[function(e){var c=e.cursor.idx;if(c){if(c!==n){n=c;try{r(e)}catch(i){}}}else a&&(t.style.display="none",a=!1)}]}}}function Me(){var e="";return{hooks:{init:[function(t){window.addEventListener("HIGHLIGHT_OPERATION",(function(n){var a=n.detail;e=a,t.redraw()}))},function(e){window.addEventListener("TOGGLE_LINE_VISIBILITY",(function(t){var n=t.detail,a=e.series.findIndex((function(e){return e.scale===n}));if(a>0){var r=e.series[a].show;e.setSeries(a,{show:!r},!1)}}))}],drawClear:function(t){if(e){var n=H.getState().operations,a=Object(l.a)(t.series[0].idxs,2),r=a[0],c=a[1],i=t.ctx,s=t.width*devicePixelRatio,o=r,u=!1;for(i.save(),i.globalAlpha=.3;o<=c;){var d=n.data[o],f=d.oper,p=d.operclr,j=Math.round(t.valToPos(t.data[0][o],"x",!0));f===e?(u?i.lineTo(s,j):(u=!0,i.beginPath(),i.moveTo(0,j),i.lineTo(s,j),i.fillStyle=p),o===c&&(i.lineTo(s,j),i.lineTo(0,j),i.closePath(),i.fill())):(u&&(i.lineTo(s,j),i.lineTo(0,j),i.closePath(),i.fill()),u=!1),o++}i.restore()}}}}}n(106);var Ue=Object(a.memo)((function(e){var t=e.dataAccessor,n=e.sync,r=Object(P.c)(B),c=Object(P.c)((function(e){return e[t]})),i=Object(P.c)((function(e){return e.settings[t]})),s=Object(P.c)(z),d=Object(P.c)(W),f=Object(a.useRef)(null);Object(a.useEffect)((function(){var e=Object(l.a)(d,2),t=e[0],n=e[1];f.current.setScale("x",{min:t,max:n})}),[d]),Object(a.useEffect)((function(){f.current.setData([r].concat(Object(o.a)(c.map((function(e){return e.data})))),!1)}),[r,c]),Object(a.useEffect)((function(){f.current.setSize(s)}),[s]);var p=Object(a.useMemo)((function(){return{width:s.width,height:s.height,legend:{show:!1},padding:[10,0,0,0],cursor:{y:!1,sync:{key:n.key,match:[x,x],filters:{sub:_}},bind:{dblclick:function(){return function(){return null}},mouseup:function(e,n,a){return function(n){if(0===n.button){var r=e.cursor.drag.setScale;e.cursor.drag.setScale=!1,a(n),e.cursor.drag.setScale=r;var c=e.posToIdx(e.select.top),i=e.posToIdx(e.select.top+e.select.height);e.setSelect({left:0,top:0,width:0,height:0},!1),c!==i&&O("CALC_VALUES_IN_AREA",{range:[c,i],dataAccessor:t})}}},mousedown:function(e,t,n){return function(t){0===t.button&&(n(t),e.root.querySelector(".u-select").classList.add("u-annotate"))}}}},class:"svg-grid",series:[{}].concat(Object(o.a)(i.map((function(e){return{scale:e.sensor_name,label:e.sensor_alias||e.sensor_name_ru,stroke:e.sensor_color,_getMetrics:e.sensor_unit,points:{show:!1},width:1}})))),axes:[{scale:"x",side:3,show:!1}],scales:i.reduce((function(e,t){var n=t.sensor_name,a=t.sensor_min,r=t.sensor_max,c=t.autoscale;return Object(u.a)(Object(u.a)({},e),{},Object(Ce.a)({},n,{ori:0,range:c?[]:[a,r]}))}),{x:{ori:1,dir:-1}}),plugins:[Le(t),Me()]}}),[i]);return Object(M.jsx)(Re.a,{options:p,data:[],onCreate:function(e){f.current=e}})})),He=n(39),Pe=(n(77),{style:{color:"#e60000",cursor:"help"},title:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435"}),Ve=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),i=Object(l.a)(c,2),s=i[0],o=i[1];return Object(a.useEffect)((function(){var e=function(e){var t=e.detail,n=t.range,a=t.dataAccessor,c=Object(l.a)(n,2),i=c[0],s=c[1],u=H.getState(),d=u[a],f=u.settings,p=u.times,j=u.depth,b=f[a],m=d.map((function(e){for(var t=e.data[i],n=e.data[i],a=0,r=i;r<=s;r++)e.data[r]<t&&(t=e.data[r]),e.data[r]>n&&(n=e.data[r]),a+=e.data[r];return{min:t,max:n,avg:a?(a/(s-i+1)).toFixed(2):"\u043d. \u0434"}})),h=w(new Date(1e3*p.data[i])),v=w(new Date(1e3*p.data[s])),O=y(p.data[s]-p.data[i]),_=(j.data[s]-j.data[i]).toFixed(2);o({series:b,values:m,interval_from:h,interval_to:v,interval:O,depth_delta:_}),r(!0)};return window.addEventListener("CALC_VALUES_IN_AREA",e),function(){return window.removeEventListener("CALC_VALUES_IN_AREA",e)}}),[]),Object(M.jsx)(He.a,{open:n,onClose:function(){return r(!1)},showCloseIcon:!1,center:!0,focusTrapped:!1,children:s&&Object(M.jsxs)("div",{children:[Object(M.jsxs)("div",{style:{paddingLeft:10},children:[Object(M.jsxs)("div",{children:[s.interval_from," - ",s.interval_to]}),Object(M.jsxs)("div",{children:["\u0412\u0440\u0435\u043c\u044f ",s.interval," (\u043f\u0440\u043e\u0445\u043e\u0434\u043a\u0430 ",s.depth_delta,"\u043c)"]})]}),Object(M.jsxs)("table",{className:"calc-result-table",children:[Object(M.jsx)("thead",{children:Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440"}),Object(M.jsx)("th",{children:"\u0415\u0434. \u0438\u0437\u043c."}),Object(M.jsx)("th",{children:"\u041c\u0438\u043d"}),Object(M.jsx)("th",{children:"\u041c\u0430\u043a\u0441"}),Object(M.jsx)("th",{children:"\u0421\u0440\u0435\u0434"})]})}),Object(M.jsx)("tbody",{children:s.series.map((function(e,t){var n=s.values[t],a=n.min,r=n.max,c=n.avg;return Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{style:{color:e.sensor_color},children:e.sensor_name_ru}),Object(M.jsx)("td",{children:e.sensor_unit}),Object(M.jsx)("td",{children:a}),Object(M.jsx)("td",Object(u.a)(Object(u.a)({},r>e.sensor_max&&Pe),{},{children:r})),Object(M.jsx)("td",{children:c})]},e.sensor_name)}))})]})]})})},Fe=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"#1f1f1f",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})},We=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"red",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})},Be=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})},Ge=function(){return Object(M.jsxs)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})},Ye=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})},ze=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})},qe=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})},Ke=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})},Je=function(){return Object(M.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})},Qe=function(e){var t=e.disabled;return Object(M.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",opacity:t?.3:1,children:Object(M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})},Xe=function(){var e=m(1800),t=Object(l.a)(e,2),n=t[0],a=t[1];O("USER_CHANGED_TIME",{time_stamp_start:n,time_stamp_stop:a,merge_step:1800,livemode:!0})},Ze=function(){var e=Object(P.c)(K),t=Object(P.c)(q),n=!e&&1===t.well_type&&"floating_livemode_btn_visible";return Object(M.jsx)("div",{className:"floating_livemode_btn ".concat(n),title:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0436\u0438\u0432\u043e\u043c\u0443 \u0440\u0435\u0436\u0438\u043c\u0443",onClick:Xe,children:Object(M.jsx)(Be,{})})},$e=function(){var e=Object(P.c)(F),t=Object(P.b)();Object(a.useEffect)((function(){var e=p((function(){return t({type:"CHECK_IF_DATA_UPDATE_NEEDED"})}),500),n=function(n){n.preventDefault(),t({type:"UPDATE_TIME_INTERVAL",payload:{delta:n.wheelDeltaY,scale:n.ctrlKey}}),e()};return window.addEventListener("wheel",n,{passive:!1}),function(){return window.removeEventListener("wheel",n)}}),[t]);var n=d.default.sync("sync_charts");return Object(M.jsxs)("div",{className:"charts-container",children:[e.map((function(e){return Object(M.jsx)(Ue,{dataAccessor:e,sync:n},e)})),Object(M.jsx)(Ve,{}),Object(M.jsx)(Ze,{})]})},et=n(174),tt=n(173),nt=Object(a.memo)((function(e){var t=e.dataAccessor,n=Object(a.useState)({}),r=Object(l.a)(n,2),c=r[0],i=r[1],s=Object(P.c)((function(e){return e.settings[t]})),o=Object(P.c)((function(e){return e.lastValues[t]||[]})),d=Object(P.c)(z);Object(a.useEffect)((function(){return i({})}),[s]);return Object(M.jsx)("div",{className:"labels-column",style:{width:d.width},children:s.map((function(e,t){return Object(M.jsxs)("div",{className:"chart-label cursor-pointer",style:{color:e.sensor_color},"data-hidden":!!c[e.sensor_name],onClick:function(){return t=e.sensor_name,i((function(e){return e.hasOwnProperty(t)?(e[t],Object(et.a)(e,[t].map(tt.a))):Object(u.a)(Object(u.a)({},e),{},Object(Ce.a)({},t,!0))})),void O("TOGGLE_LINE_VISIBILITY",t);var t},title:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c/\u0421\u043a\u0440\u044b\u0442\u044c",children:[Object(M.jsx)("span",{children:e.sensor_min}),Object(M.jsxs)("span",{title:e.sensor_name_ru,children:[e.sensor_alias||e.sensor_name_ru,": ",o[t]," ",e.sensor_unit]}),Object(M.jsx)("span",{children:e.sensor_max})]},e.sensor_name)}))})})),at=function(){var e=Object(P.c)(F);return Object(M.jsx)("div",{className:"labels-container",children:e.map((function(e){return Object(M.jsx)(nt,{dataAccessor:e},e)}))})};var rt=function(){var e=Object(P.c)(B),t=Object(P.c)(G),n=Object(P.c)(z),r=Object(P.c)(W),c=Object(P.c)(Q),i=Object(a.useRef)(null);!function(){var e=Object(P.b)();Object(a.useEffect)((function(){if("ontouchstart"in window){var t=p((function(){return e({type:"CHECK_IF_DATA_UPDATE_NEEDED"})}),1e3),n=document.querySelector(".mobile-touch-events"),a=p((function(n){n.distance>5&&(e({type:"UPDATE_TIME_INTERVAL",payload:{delta:Ie[n.additionalEvent],scale:!0}}),t())}),50),r=p((function(n){e({type:"UPDATE_TIME_INTERVAL",payload:{delta:Ie[n.additionalEvent],scale:!1}}),t()}),50),c=new Se.a(n);c.get("pinch").set({enable:!0}).dropRecognizeWith("pan"),c.get("pan").set({threshold:50,direction:Se.a.DIRECTION_VERTICAL}).dropRecognizeWith("pinch"),c.on("pinch",a),c.on("pan",r)}}),[e])}(),Object(a.useEffect)((function(){var e=Object(l.a)(r,2),t=e[0],n=e[1];i.current.setScale("x",{min:t,max:n})}),[r,c]),Object(a.useEffect)((function(){i.current.setData([e,t],!1)}),[e,t,c]),Object(a.useEffect)((function(){i.current.setSize({width:140,height:n.height})}),[n]);var s=Object(a.useMemo)((function(){return{width:140,height:n.height,legend:{show:!1},padding:[10,0,0,0],class:"mobile-touch-events",cursor:{show:!1},series:[{},{scale:"depth",points:{show:(e=c.color,function(t,n,a,r){var c=t.ctx,i=a,s=null,o=null;c.fillStyle=e;for(var l=113*devicePixelRatio,u=20*devicePixelRatio;i<=r;){var d=Math.floor(t.data[n][i]);if(s!==d){var f=Math.round(t.valToPos(t.data[0][i],"x",!0));f-o>u&&(s=d,o=f,c.fillText(d+"\u043c",l,f))}i++}})}}],axes:[{scale:"x",side:3,size:60,grid:{show:!1},values:C,stroke:c.color,ticks:{show:!1}}],scales:{x:{ori:1,dir:-1},depth:{ori:0}}};var e}),[c]);return Object(M.jsx)(Re.a,{options:s,data:[],onCreate:function(e){return i.current=e}})};function ct(e){e.over.addEventListener("click",(function(){for(var t=H.getState(),n=t.operations,a=t.times,r=t.depth,c=Object(l.a)(e.series[0].idxs,2),i=c[0],s=c[1],o=a.data[s]-a.data[i],u={},d=n.data[i].oper,f=a.data[i],p=i;p<=s;p++)if(d!==n.data[p].oper||p===s){var j=a.data[p]-f;if(u[d]){var b=u[d];u[d]=b+j}else u[d]=j;d=n.data[p].oper,f=a.data[p]}var m=function(e){return O("HIGHLIGHT_OPERATION",e.target.textContent)},h=(r.data[s]-r.data[i]).toFixed(2),v=Object.entries(u).map((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1],r=y(a),c=(a/o*100).toFixed(2);return Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{onClick:m,children:n}),Object(M.jsx)("td",{children:"".concat(r," (").concat(c,"%)")})]},n)})),_=function(){return Object(M.jsxs)("div",{children:["\u041f\u0440\u043e\u0445\u043e\u0434\u043a\u0430: ",h," \u043c",Object(M.jsxs)("table",{width:"100%",children:[Object(M.jsx)("thead",{children:Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{align:"left",children:"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f"}),Object(M.jsx)("th",{align:"left",children:"\u0412\u0440\u0435\u043c\u044f"})]})}),Object(M.jsx)("tbody",{children:v})]})]})};if(E.b.isActive("interval_summary"))return E.b.update("interval_summary",{render:_});Object(E.b)(_,{closeOnClick:!1,onClose:function(){return O("HIGHLIGHT_OPERATION","")},position:E.b.POSITION.BOTTOM_RIGHT,toastId:"interval_summary"})}))}function it(){var e=document.createElement("div");e.className="u-tooltip u-tooltip-operations";var t=null,n=!1;function a(a){n||(e.style.display="block",n=!0);var r=a.valToPos(a.data[0][t],"x"),c=0;a.height-r<50&&(c=50),e.style.top=r-c+"px";var i=a.data[1][t],s=i.oper,o=void 0===s?"\u043d. \u0434":s,l=i.suboper,u=void 0===l?"":l,d=i.suboperclr;e.style.borderColor=d,e.innerHTML="<p>".concat(o,"</p><p>").concat(u,"</p>")}return{hooks:{init:[ct,De],ready:[function(t){return t.root.querySelector(".u-wrap").appendChild(e)}],setCursor:[function(r){var c=r.cursor.idx;c?c!==t&&(t=c,a(r)):n&&(e.style.display="none",n=!1)}]}}}function st(e,t,n,a){for(var r=e.ctx,c=n,i=60*devicePixelRatio,s=null,o=!1;c<=a;){var l=e.data[t][c],u=l.oper,d=l.suboper,f=l.suboperclr,p=u+d,j=Math.round(e.valToPos(e.data[0][c],"x",!0));s!==p?(s=p,o&&(r.lineTo(i,j),r.lineTo(0,j),r.closePath(),r.fill()),r.beginPath(),r.moveTo(0,j),r.lineTo(i,j),r.fillStyle=f,o=!0):(r.lineTo(i,j),c===a&&(r.lineTo(0,j),r.closePath(),r.fill())),c++}}var ot=function(){var e=Object(P.c)(B),t=Object(P.c)(z),n=Object(P.c)(W),r=Object(P.c)(Y),c=Object(a.useRef)(null);Object(a.useEffect)((function(){var e=Object(l.a)(n,2),t=e[0],a=e[1];c.current.setScale("x",{min:t,max:a})}),[n]),Object(a.useEffect)((function(){c.current.setData([e,r],!1)}),[e,r]),Object(a.useEffect)((function(){c.current.setSize({width:60,height:885})}),[t]);var i=Object(a.useMemo)((function(){return{width:60,height:t.height,legend:{show:!1},padding:[10,0,0,0],cursor:{y:!1,drag:{x:!1},bind:{dblclick:function(){return function(){return null}}}},class:"cursor-pointer",series:[{},{scale:"operations",points:{show:st}}],axes:[{scale:"x",show:!1}],scales:{x:{ori:1,dir:-1},operations:{ori:0}},plugins:[it()]}}),[]);return Object(M.jsx)(Re.a,{options:i,data:[],onCreate:function(e){return c.current=e}})},lt=function(){var e=Object(P.c)(q),t="".concat(e.fieldname," \xb7 ").concat(e.padname," \xb7 ").concat(e.wellname);return Object(a.useEffect)((function(){window.document.title=t}),[]),Object(M.jsx)("div",{style:{textAlign:"center"},children:t})},ut=n(508),dt=n(503),ft=n(504),pt=(n(497),n(498),function(){var e=Object(P.c)(J),t=Object(P.c)(K),n=Object(P.c)(Q),a=Object(M.jsxs)("div",{style:{width:130,display:"flex",cursor:"pointer"},children:[Object(M.jsxs)("div",{style:{lineHeight:"20px"},children:["\u043c\u0430\u0441\u0448\u0442\u0430\u0431: ",R[e]]}),Object(M.jsx)("span",{style:{width:15,height:17,alignSelf:"flex-end"},children:Object(M.jsx)(ze,{})})]});return Object(M.jsxs)(ut.a,{menuButton:a,theming:n.active_theme,onItemClick:function(e){return O("USER_CHANGED_TIME",function(e,t){if(e){var n=m(t),a=Object(l.a)(n,2);return{time_stamp_start:a[0],time_stamp_stop:a[1],merge_step:t,livemode:e}}var r=H.getState().timeInterval,c=Object(l.a)(r,1)[0];return{time_stamp_start:c,time_stamp_stop:c+t,merge_step:t}}(t,e.value))},children:[Object(M.jsx)(dt.a,{children:"\u0432\u044b\u0431\u043e\u0440 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0430"}),N.map((function(e){return Object(M.jsx)(ft.a,{value:e.key,disabled:t&&e.disabled_in_livemode,children:e.label},e.key)}))]})}),jt=(n(505),n(506),n(507),function(){var e=Object(P.c)(Q),t=Object(P.b)();return Object(M.jsx)("div",{onClick:function(){t({type:"SET_THEME",payload:e.active_theme===k?T:k})},style:{cursor:"pointer",width:20,height:20},title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0442\u0435\u043c\u0443",children:e.active_theme===k?Object(M.jsx)(Ke,{}):Object(M.jsx)(Je,{})})}),bt=function(){var e=window.document,t=e.documentElement,n=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,a=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?a.call(e):n.call(t)},mt=function(){return Object(M.jsx)("div",{onClick:bt,style:{cursor:"pointer",width:20,height:20},title:"\u041f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c",children:Object(M.jsx)(qe,{})})},ht=n(171),vt=function(e){var t=e.openChartSettings,n=e.onCloseChartSettingsModal,a=e.changingSensor,r=e.setSensorSettings,c=e.deleteSensorFromBlock,i=Object(u.a)({},(null===a||void 0===a?void 0:a.sensor)||{});return Object(M.jsx)(He.a,{open:t,onClose:n,showCloseIcon:!1,center:!0,children:a?Object(M.jsxs)("form",{className:"sensor-settings",children:[Object(M.jsx)("div",{children:null===i||void 0===i?void 0:i.sensor_name_ru}),Object(M.jsx)("div",{children:Object(M.jsx)(ht.a,{color:i.sensor_color,onChange:function(e){i.sensor_color=e}})}),Object(M.jsxs)("span",{children:["\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f (",Object(M.jsx)("span",{className:"sensor-settings__units",children:null===i||void 0===i?void 0:i.sensor_unit}),")"]}),Object(M.jsxs)("div",{children:[Object(M.jsxs)("div",{className:"sensor-settings_input-wrapper",children:[Object(M.jsx)("label",{className:"sensor-settings_input-label",htmlFor:"minVal",children:"\u041e\u0442:"}),Object(M.jsx)("input",{onChange:function(e){i.sensor_min=parseFloat(e.target.value.replace(",","."))},id:"minVal",type:"number",defaultValue:(null===i||void 0===i?void 0:i.sensor_min)||0})]}),Object(M.jsxs)("div",{className:"sensor-settings_input-wrapper",children:[Object(M.jsx)("label",{className:"sensor-settings_input-label",htmlFor:"maxVal",children:"\u0414\u043e:"}),Object(M.jsx)("input",{onChange:function(e){i.sensor_max=parseFloat(e.target.value.replace(",","."))},id:"maxVal",type:"number",defaultValue:(null===i||void 0===i?void 0:i.sensor_max)||0})]})]}),Object(M.jsxs)("label",{children:[Object(M.jsx)("input",{type:"checkbox",defaultChecked:null===i||void 0===i?void 0:i.autoscale,onChange:function(e){i.autoscale=e.target.checked},style:{marginRight:10}}),"\u0410\u0432\u0442\u043e\u043c\u0430\u0441\u0448\u0442\u0430\u0431"]}),Object(M.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:15,width:"100%"},children:[Object(M.jsx)("div",{className:"sensor-settings_submit-button",style:{color:"#FF000D"},onClick:c,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),Object(M.jsx)("div",{className:"sensor-settings_submit-button",onClick:r(i),children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]})]}):null})},Ot=function(){var e=Object(P.c)(q),t=Object(a.useState)([]),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)([]),s=Object(l.a)(i,2),d=s[0],f=s[1],p=Object(a.useState)(null),j=Object(l.a)(p,2),b=j[0],m=j[1],h=Object(a.useState)(!1),v=Object(l.a)(h,2),_=v[0],x=v[1],w=Object(a.useState)(!1),y=Object(l.a)(w,2),E=y[0],k=y[1],T=Object(a.useState)(null),S=Object(l.a)(T,2),I=S[0],D=S[1];Object(a.useEffect)((function(){var e=H.getState(),t=e.settings,n=e.all_sensors,a=Object.values(g(t));f(n),c(a)}),[e]);var A=function(){return x(!1)},C=function(){return k(!1)},N=function(e){return c((function(t){var n=Object(o.a)(t);return n.splice(e,1),n}))},R=function(e){e.preventDefault(),e.currentTarget.style.boxShadow="4px 4px 8px 0px rgba(31, 31, 31, 0.4)"},L=function(e){e.currentTarget.style.boxShadow="none"},U=function(e){e.currentTarget.style.boxShadow="none"};"Default"===e.active_preset_name||e.active_preset_name;return Object(M.jsxs)("div",{children:[Object(M.jsx)("div",{onClick:function(){return x(!0)},style:{cursor:"pointer",width:20,height:20},children:Object(M.jsx)(Ge,{})}),Object(M.jsxs)(He.a,{focusTrapped:!1,open:_,onClose:A,showCloseIcon:!1,center:!0,styles:{modal:{maxWidth:"100%"}},children:[Object(M.jsxs)("div",{className:"config-container__wrapper",children:[Object(M.jsx)("form",{className:"config-container__head",onSubmit:function(e){e.preventDefault();document.querySelector("#preset_name_input");O("CONFIG_HAS_CHANGED",{type:"update",name:"save",settings:r}),A()},children:Object(M.jsx)("button",{className:"cursor-pointer",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})}),Object(M.jsx)("form",{className:"config-container__head",onSubmit:function(e){e.preventDefault(),O("CONFIG_HAS_CHANGED",{type:"update",name:"empty",settings:null}),A()},children:Object(M.jsx)("button",{className:"cursor-pointer",title:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438, \u0432\u0437\u044f\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e...",children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})})]}),Object(M.jsxs)("div",{className:"config-container__wrap",children:[r.map((function(e,t){return Object(M.jsxs)("div",{onDragOver:R,onDragLeave:L,onDragEnd:U,onDrop:function(n){return function(e,t,n){e.currentTarget.style.boxShadow="none";var a=b.fromBlock,r=b.fromBlockIndex,i=b.draggingIndex,s=b.draggingItem;t.push(s),a.splice(i,1),c((function(e){return e.map((function(e,c){return c===r?a:c===n?t:e}))}))}(n,e,t)},className:"drop-container__block",children:[Object(M.jsxs)("div",{className:"drop-container__title",children:[Object(M.jsxs)("select",{defaultValue:"add",onChange:function(n){return function(e,t,n){var a=Object(u.a)({sensor_name:e.target.value},d[e.target.value]);n.push(a),c((function(e){return e.map((function(e,a){return a===t?n:e}))})),e.target.value="add"}(n,t,e)},children:[Object(M.jsx)("option",{value:"add",disabled:!0,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a"}),Object.entries(d).filter((function(e){var t=Object(l.a)(e,1)[0];return!r.flat().find((function(e){return e.sensor_name===t}))})).map((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(M.jsx)("option",{value:n,children:a.sensor_name_ru},n)}))]}),Object(M.jsx)("span",{style:{width:20},onClick:N.bind(null,t),title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u043b\u043e\u043a",children:Object(M.jsx)(We,{})})]}),e.map((function(n,a){return Object(M.jsx)("div",{className:"drag-item__sensor",draggable:!0,onDragStart:function(){m({fromBlock:e,fromBlockIndex:t,draggingIndex:a,draggingItem:n})},onClick:function(){return function(e,t,n){D({blockIndex:e,sensorIndex:t,sensor:n}),k(!0)}(t,a,n)},style:{color:n.sensor_color,padding:"10px 0px",transition:"box-shadow 300ms ease"},children:n.sensor_name_ru},n.sensor_name)}))]},t)})),r.length<5&&Object(M.jsx)("div",{style:{minHeight:400,width:50,display:"flex"},onClick:function(){return c((function(e){return[].concat(Object(o.a)(e),[[]])}))},title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0431\u043b\u043e\u043a",children:Object(M.jsx)(Fe,{})})]})]}),Object(M.jsx)(vt,{openChartSettings:E,onCloseChartSettingsModal:C,changingSensor:I,setSensorSettings:function(e){return function(){c((function(t){return t.map((function(t,n){return n===I.blockIndex?t.map((function(t,n){return I.sensorIndex===n?e:t})):t}))})),C()}},deleteSensorFromBlock:function(){c((function(e){return e.map((function(e,t){return t===I.blockIndex?e.filter((function(e,t){return t!==I.sensorIndex})):e}))})),C()}})]})},_t=function(){return Object(M.jsxs)("div",{className:"header-panel",children:[Object(M.jsx)("div",{style:{display:"flex",gap:10,zIndex:101},children:Object(M.jsx)(pt,{})}),Object(M.jsx)(lt,{}),Object(M.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:10},children:[Object(M.jsx)(jt,{}),Object(M.jsx)(mt,{}),Object(M.jsx)(Ot,{})]})]})},xt=function(){var e=Object(P.c)(q),t=Object(a.useState)(!1),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Object(a.useRef)(null),s=Object(a.useRef)(null),o=function(){return c(!1)},d=Object(a.useMemo)((function(){var t=v(e.start_building),n=1===e.well_type?(new Date).toISOString().replace(/T.*/,"T"+(new Date).toLocaleTimeString()):v(e.finish_building);return{min:t,max:n,defaultValue:1===e.well_type?(new Date).toISOString().replace(/T.*/,"T00:00"):n}}),[e]);return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{onClick:function(){return c(!0)},style:{width:25,cursor:"pointer"},title:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b",children:Object(M.jsx)(Ye,{})}),Object(M.jsx)(He.a,{open:r,onClose:o,showCloseIcon:!1,center:!0,focusTrapped:!1,children:Object(M.jsx)("div",{className:"settings-modal",children:Object(M.jsxs)("div",{className:"settings-modal-item",children:[Object(M.jsx)("div",{className:"settings-modal-heading",children:"\u0412\u044b\u0431\u043e\u0440 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u0430"}),Object(M.jsxs)("div",{children:[Object(M.jsx)("label",{htmlFor:"time-start",children:"\u041d\u0430\u0447\u0430\u043b\u043e: "}),Object(M.jsx)("input",Object(u.a)({ref:i,type:"datetime-local",id:"time-start"},d)),Object(M.jsx)("label",{htmlFor:"time-adder",children:" + "}),Object(M.jsx)("select",{id:"time-adder",ref:s,defaultValue:86400,children:N.map((function(e){return Object(M.jsx)("option",{value:e.key,children:e.label},e.key)}))})]}),Object(M.jsx)("button",{onClick:function(){var e=i.current.value,t=new Date(e).getTime()/1e3;if(t>0){var n=+s.current.value;O("USER_CHANGED_TIME",{time_stamp_start:t,time_stamp_stop:t+n,merge_step:n}),o()}},children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438"})]})})})]})},gt=function(){var e=Object(P.c)(K);return Object(M.jsx)("div",{onClick:function(){if(!e){var t=H.getState(),n=t.timeInterval,a=t.merge_step,r=Object(l.a)(n,2),c=r[0],i=r[1];if(i-c>=60)O("USER_CHANGED_TIME",{time_stamp_start:c,time_stamp_stop:i,merge_step:a})}},style:{width:25,cursor:e?"not-allowed":"pointer"},title:e?"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 \u0436\u0438\u0432\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435":"\u0414\u0435\u0442\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b",children:Object(M.jsx)(Qe,{disabled:e})})},wt=function(){return Object(M.jsxs)("div",{className:"metric",children:[Object(M.jsxs)("div",{className:"metric-label metric-label-time",children:[Object(M.jsx)(xt,{}),Object(M.jsx)("div",{children:"\u0412\u0440\u0435\u043c\u044f"})]}),Object(M.jsxs)("div",{className:"metric-label metric-label-depth",children:[Object(M.jsx)(gt,{}),Object(M.jsx)("div",{title:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430 \u043f\u043e \u0441\u0442\u0432\u043e\u043b\u0443",children:"\u0413\u043b\u0443\u0431."})]}),Object(M.jsx)("div",{className:"metric-label flex-end",title:"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0438",children:"\u041e\u043f\u0435\u0440."})]})};n(17),n(499);var yt,Et=function(){var e=Object(a.useState)(Tt?1:0),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(P.b)();return Object(P.c)(V),function(){var e=A.wellid,t=A.authid,n=Object(P.b)();Object(a.useEffect)((function(){var a=function(){var e=Object($.a)(Z.a.mark((function e(){var n,a;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("access_token")||!t){e.next=6;break}return e.next=3,le(t);case 3:n=e.sent,a=n.data,re(a);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var t=Object($.a)(Z.a.mark((function t(){var n,a,r;return Z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new URLSearchParams({wellid:e}),t.t1=kt,!t.t1){t.next=6;break}return t.next=5,ue(n);case 5:t.t1=t.sent;case 6:if(t.t0=t.t1,t.t0){t.next=11;break}return t.next=10,we();case 10:t.t0=t.sent;case 11:return a=t.t0,r=a.data,t.abrupt("return",r);case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=function(){var t=Object($.a)(Z.a.mark((function t(a){var r,c,i,s,o,u,d,f,p,j,b,v;return Z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=a.info,s=i.well_type,o=i.finish_building,u=1===s?m(1800):h(o),d=Object(l.a)(u,2),f=d[0],p=d[1],j=kt&&new URLSearchParams({wellid:e,time_stamp_start:f,time_stamp_stop:p})||{time_stamp_start:f,time_stamp_stop:p},t.t1=kt,!t.t1){t.next=8;break}return t.next=7,fe(j);case 7:t.t1=t.sent;case 8:if(t.t0=t.t1,t.t0){t.next=13;break}return t.next=12,Ee(j);case 12:t.t0=t.sent;case 13:b=t.t0,(null===(v=b.data)||void 0===v||null===(r=v.DataTimes)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.length)>0&&n({type:"CREATE_STRUCTURE",payload:{config:a,data:v}});case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();!function(){var e=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=kt,!e.t0){e.next=4;break}return e.next=4,a();case 4:r().then(c);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()();var i=function(){var t=Object($.a)(Z.a.mark((function t(a){var r,c,i,s,o,d,f,p,j,b,m,h,v,O,_,x,g,w,y,E,k,T;return Z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=a.detail,s=H.getState(),o=s.timeInterval,d=s.info,f=s.all_sensors,p=Object(l.a)(o,2),j=p[0],b=p[1],m=new URLSearchParams({wellid:e,time_stamp_start:j,time_stamp_stop:b}),t.t1=kt,!t.t1){t.next=9;break}return t.next=8,fe(m);case 8:t.t1=t.sent;case 9:if(t.t0=t.t1,t.t0){t.next=14;break}return t.next=13,Ee(m);case 13:t.t0=t.sent;case 14:if(h=t.t0,!((null===(v=h.data)||void 0===v||null===(r=v.DataTimes)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.length)>0)){t.next=42;break}if(null!==i.settings){t.next=24;break}return t.next=20,we("default");case 20:O=t.sent,n({type:"CREATE_STRUCTURE",payload:{config:{info:Object(u.a)(Object(u.a)({},d),{},{active_preset_id:1,active_preset_name:"default"}),all_sensors:f,settings:O.data.settings},data:v}}),_=document.querySelector(".root2__wrapper"),n({type:"UPDATE_BLOCK_BOUNDING",payload:{containerWidth:_.clientWidth-210,containerHeight:_.clientHeight}});case 24:if("update"!==i.type||null===i.settings){t.next=41;break}if(t.t3=kt,!t.t3){t.next=30;break}return t.next=29,de(new URLSearchParams({name:i.name}),i.settings);case 29:t.t3=t.sent;case 30:if(t.t2=t.t3,t.t2){t.next=35;break}return t.next=34,xe(i.settings);case 34:t.t2=t.sent;case 35:x=t.t2,g=x.data,w=g.id,y=g.name,n({type:"CREATE_STRUCTURE",payload:{config:{info:Object(u.a)(Object(u.a)({},d),{},{active_preset_id:w,active_preset_name:y}),all_sensors:f,settings:i.settings},data:v}}),E=document.querySelector(".root2__wrapper"),n({type:"UPDATE_BLOCK_BOUNDING",payload:{containerWidth:E.clientWidth-210,containerHeight:E.clientHeight}});case 41:"apply"===i.type&&(k=i.id,T=i.name,n({type:"CREATE_STRUCTURE",payload:{config:{info:Object(u.a)(Object(u.a)({},d),{},{active_preset_id:k,active_preset_name:T}),all_sensors:f,settings:i.settings},data:v}}));case 42:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return window.addEventListener("CONFIG_HAS_CHANGED",i),function(){return window.removeEventListener("CONFIG_HAS_CHANGED",i)}}),[])}(),function(){var e=Object(P.b)();Object(a.useEffect)((function(){var t=f((function(){var t=document.querySelector(".root2__wrapper");e(t?{type:"UPDATE_BLOCK_BOUNDING",payload:{containerWidth:t.clientWidth-210,containerHeight:t.clientHeight}}:{type:"UPDATE_BLOCK_BOUNDING",payload:{containerWidth:window.innerWidth-210,containerHeight:window.innerHeight}})}),500);return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[e])}(),function(){var e=A.wellid,t=Object(P.b)();Object(a.useEffect)((function(){var n=function(){var n=Object($.a)(Z.a.mark((function n(a){var r,c,i,s,o,u,d,f;return Z.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=Object(l.a)(a,2),s=i[0],o=i[1],u=kt&&new URLSearchParams({wellid:e,time_stamp_start:s,time_stamp_stop:o})||{time_stamp_start:s,time_stamp_stop:o},n.t1=kt,!n.t1){n.next=7;break}return n.next=6,fe(u);case 6:n.t1=n.sent;case 7:if(n.t0=n.t1,n.t0){n.next=12;break}return n.next=11,Ee(u);case 11:n.t0=n.sent;case 12:d=n.t0,(null===(f=d.data)||void 0===f||null===(r=f.DataTimes)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.length)>0&&t({type:"MERGE_WITH_UPDATE",payload:{data:f,range:a}});case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),a=function(){var n=Object($.a)(Z.a.mark((function n(a){var r,c,i,s,o,l,u,d,f,p;return Z.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=a.time_stamp_start,s=a.time_stamp_stop,o=a.merge_step,l=a.livemode,u=void 0!==l&&l,d=kt&&new URLSearchParams({wellid:e,time_stamp_start:i,time_stamp_stop:s})||{time_stamp_start:i,time_stamp_stop:s},n.t1=kt,!n.t1){n.next=7;break}return n.next=6,fe(d);case 6:n.t1=n.sent;case 7:if(n.t0=n.t1,n.t0){n.next=12;break}return n.next=11,Ee(d);case 11:n.t0=n.sent;case 12:f=n.t0,p=f.data,!1===u&&t({type:"OFF_LIVEMODE"}),(null===p||void 0===p||null===(r=p.DataTimes)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.length)>0&&t({type:"UPDATE_CHARTS",payload:{data:p,merge_step:o,livemode:u}});case 16:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),r=function(e){return n(e.detail)},c=function(e){return a(e.detail)};return window.addEventListener("REQUEST_DATA_UPDATE",r),window.addEventListener("USER_CHANGED_TIME",c),function(){window.removeEventListener("REQUEST_DATA_UPDATE",r),window.removeEventListener("USER_CHANGED_TIME",c)}}),[])}(),function(){var e=Object(P.c)(V),t=Object(P.c)(K),n=Object(P.c)(q),r=A.wellid,c=Object(P.b)();Object(a.useEffect)((function(){if(kt){var a,i,s=function(){var e=Object($.a)(Z.a.mark((function e(){var t,n,a;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URLSearchParams({wellid:r}),e.next=3,pe(t);case 3:return n=e.sent,a=n.data,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(e){var t=e.id_stream;(a=new WebSocket("wss://ir-backend-02.rigintelpro.ru/api/v1/charts/ws2/".concat(t))).onopen=function(){},a.onclose=function(e){3e3===e.code&&l(),e.code},a.onmessage=function(e){var t=JSON.parse(e.data);c({type:"ADD_DATA_FROM_SOCKET",payload:t})}};function l(){s().then(o)}return"READY"===e&&t&&1===n.well_type?l():null===(i=a)||void 0===i||i.close(),function(){var e;null===(e=a)||void 0===e||e.close()}}var u;return"READY"===e&&t&&1===n.well_type&&(u=setInterval((function(){if(je().showing.status){function e(){return(e=Object($.a)(Z.a.mark((function e(){var t;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe("live");case 2:t=e.sent,c({type:"ADD_DATA_FROM_SOCKET",payload:t});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}}),1e3)),function(){clearInterval(u)}}),[e,t,c,r,null===n||void 0===n?void 0:n.well_type])}(),je().showing.fn=function(e){je().showing.status=e,r(e)},Object(a.useEffect)((function(){return n&&c({type:"UPDATE_BLOCK_BOUNDING",payload:{containerWidth:document.querySelector(".root2__wrapper").clientWidth-210,containerHeight:document.querySelector(".root2__wrapper").clientHeight}}),function(){}}),[n]),console.log("react RState()",je()),Object(M.jsx)("div",{className:"root2__wrapper",style:{display:1===n?"block":"none",visibility:je().showing.status?"visible":"hidden"},children:1===n||kt?Object(M.jsxs)("div",{className:"chart-app",children:[Object(M.jsx)(_t,{}),Object(M.jsxs)("div",{className:"charts-labels-area",children:[Object(M.jsx)(wt,{}),Object(M.jsx)(at,{})]}),Object(M.jsxs)("div",{className:"charts-main-area",children:[Object(M.jsxs)("div",{className:"metric",children:[Object(M.jsx)(rt,{}),Object(M.jsx)(ot,{})]}),Object(M.jsx)($e,{})]}),Object(M.jsx)(Ae,{})]}):"null"})},kt=(n(500),n(501),!1),Tt=!1;function St(){window.parent.rigintel={},window.parent.rigintel.state={},window.parent.rigintel.state.showing={status:0,fn:void 0},window.parent.rigintel.state.exchangeStatus={reactAppStatus:"starting"}}St(),new Promise((function(e){yt=setInterval((function(){var t=window.webMI,n=window.parent[0],a="loaded"===window.parent.rigintel.state.exchangeStatus.scriptAtviseStatus;t&&n&&a&&e()}),100)})).then((function(e){clearInterval(yt);document;var t=document.getElementById("root"),n=Tt&&document.getElementById("root2")||window.parent.document.getElementById("root2"),a=kt&&t||n;console.log("rootAtvise: ",n),i.a.render(Object(M.jsx)(r.a.StrictMode,{children:Object(M.jsx)(P.a,{store:H,children:Object(M.jsx)(Et,{})})}),a)}))}},[[502,1,2]]]);