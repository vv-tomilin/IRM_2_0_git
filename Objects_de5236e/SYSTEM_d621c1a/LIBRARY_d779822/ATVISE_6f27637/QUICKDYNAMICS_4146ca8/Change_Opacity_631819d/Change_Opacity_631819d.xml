<?xml version="1.0" encoding="UTF-8"?>
<script>
  <metadata>
	<icon type="image/png">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</icon>
	<visible>1</visible>
	<title>Change Opacity</title>
	<description>Changes the opacity of an element by a node value.</description>
  </metadata>
  <parameter name="nodeId" description="node triggering the change" valuetype="address" defaultvalue="" config="" behavior="optional" group=""/>
  <parameter name="minRange" description="min of range" valuetype="number" defaultvalue="0" config="" behavior="optional" group=""/>
  <parameter name="maxRange" description="max of range" valuetype="number" defaultvalue="100" config="" behavior="optional" group=""/>
  <parameter name="StartFill" description="lowest opacity" valuetype="number" defaultvalue="0" config="" behavior="optional" group=""/>
  <parameter name="StopFill" description="highest opacity" valuetype="number" defaultvalue="1" config="" behavior="optional" group=""/>
  <parameter name="StartStroke" description="lowest stroke" valuetype="number" defaultvalue="" config="" behavior="optional" group=""/>
  <parameter name="StopStroke" description="highest stroke" valuetype="number" defaultvalue="" config="" behavior="optional" group=""/>
  <code><![CDATA[// This Quick Dynamic sets the opacity of the fill color and/or stroke color of the applied graphical element depending on the value of the defined node and the ranged defined by
// "minRange" and "maxRange", i.e. the range defined by "minRange" and "maxRange" will be translated to the range defined by "StartFill" and "StopFill" and/or to the range defined by
// "StartStroke" and "StopStroke".
// The opacity for the fill color will only be set if both "StartFill" and "StopFill" are defined.
// The opacity for the stroke color will only be set if both "StartStroke" and "StopStroke" are defined.
// e.g.: the defined range of the value from 0 (=minRange) to 100 (=maxRange) will be translated to 0 (=StartFill) to 1 (=StopFill) where 1 means 100% opacity
// Parameters:
//	nodeId:			this node triggers this Quick Dynamic
//	minRange:		lower bound of the range where the node's value should lie in
//	maxRange:		upper bound of the range where the node's value should lie in
//	StartFill:		value for the lowest opacity in percent
//	StopFill:		value for the highest opacity in percent (1=100%)
//	StartStroke:	value for the lowest stroke in percent
//	StopStroke:		value for the highest stroke in percent (1=100%)
var AggregateManager = webMI.callExtension("SYSTEM.LIBRARY.ATVISE.QUICKDYNAMICS.Aggregate Manager");
webMI.addOnunload(function unloadAggregateManager() {
	AggregateManager.destroy();
	AggregateManager = null;
});

AggregateManager.subscribeNodeOrAggregate(base.nodeId, handleResult);

function handleResult(e) {
	var value = e.value;
	if (base.StartFill != "" && base.StopFill != "") {
		webMI.gfx.setFillOpacity(base.id, webMI.translate(value, base.minRange, base.maxRange, base.StartFill, base.StopFill));
	}
	if (base.StartStroke != "" && base.StopStroke != "") {
		webMI.gfx.setStrokeOpacity(base.id, webMI.translate(value, base.minRange, base.maxRange, base.StartStroke, base.StopStroke));
	}
}
]]></code>
</script>
